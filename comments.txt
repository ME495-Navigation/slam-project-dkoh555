Does not pass all tests.
Tests seem to hang forever.
